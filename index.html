<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ca">
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
	<title>OpenStreetMap Traffic signs Map</title>
	<meta content="OpenStreetMap POIs Map" name="description"/>
	<link rel="stylesheet" href="src/api/jquery-ui-1.12.1.custom/jquery-ui.min.css" type="text/css"/>
	<link rel="stylesheet" href="src/api/openlayers/v6.2.2-custom/ol.css" type="text/css"/>
	<link rel="stylesheet" href="src/css/font-awesome.css" type="text/css"/>
	<link rel="stylesheet" href="src/css/index.css" type="text/css"/>
	<link rel="icon" href="favicon.ico"/>
</head>
<body>
	<div class="flex-row">
		<div id="map" class="map">Loading... You need Javascript...Cargando necesitas Javascript...Carregant...necessites Javascript</div>
		<div id="menu" class="menu"></div>
	</div>
	<script src="src/api/jquery/3.4.1/jquery.min.js" defer=""></script>
	<script src="src/api/jquery-ui-1.12.1.custom/jquery-ui.min.js" defer=""></script>
	<script src="src/api/openlayers/v6.2.2-custom/ol.js" defer=""></script>
	<script src="src/config.js" defer=""></script>
	<script src="src/index.js" defer=""></script>
	<script src="src/index.js" defer=""></script>
	<link rel="stylesheet" href="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.css" />
<script type="text/javascript" src="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.js"></script>
<script>
// Set the search control 
  var search = new ol.control.SearchNominatim({
    //target: $(".options").get(0),
    polygon: $("#polygon").prop("checked"),
    reverse: true,
    position: true	// Search, with priority to geo position
  });
  map.addControl (search);

  // Select feature when click on the reference index
  search.on('select', function(e) {
    // console.log(e);
    sLayer.getSource().clear();
    // Check if we get a geojson to describe the search
    if (e.search.geojson) {
      var format = new ol.format.GeoJSON();
      var f = format.readFeature(e.search.geojson, { dataProjection: "EPSG:4326", featureProjection: map.getView().getProjection() });
      sLayer.getSource().addFeature(f);
      var view = map.getView();
      var resolution = view.getResolutionForExtent(f.getGeometry().getExtent(), map.getSize());
      var zoom = view.getZoomForResolution(resolution);
      var center = ol.extent.getCenter(f.getGeometry().getExtent());
      // redraw before zoom
      setTimeout(function(){
        view.animate({
        center: center,
        zoom: Math.min (zoom, 16)
      });
      }, 100);
    } else {
      map.getView().animate({
        center:e.coordinate,
        zoom: Math.max (map.getView().getZoom(),16)
      });
    }
  });
</script>
</body>
</html>
